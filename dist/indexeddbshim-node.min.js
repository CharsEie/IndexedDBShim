/*! indexeddbshim - v2.2.2 - 2016-06-12 */

!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){(function(a){!function(c){"use strict";function d(b){if("function"==typeof e)return e(b);if("function"==typeof a)return new a(b,"base64").toString("binary");if("object"==typeof c.base64js){var d=c.base64js.b64ToByteArray(b);return Array.prototype.map.call(d,function(a){return String.fromCharCode(a)}).join("")}throw new Error("you're probably in an ios webworker. please include use beatgammit's base64-js")}var e=c.atob;c.atob=d,"undefined"!=typeof b&&(b.exports=d)}(window)}).call(this,a("buffer").Buffer)},{buffer:3}],2:[function(a,b,c){"use strict";function d(){for(var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b=0,c=a.length;c>b;++b)i[b]=a[b],j[a.charCodeAt(b)]=b;j["-".charCodeAt(0)]=62,j["_".charCodeAt(0)]=63}function e(a){var b,c,d,e,f,g,h=a.length;if(h%4>0)throw new Error("Invalid string. Length must be a multiple of 4");f="="===a[h-2]?2:"="===a[h-1]?1:0,g=new k(3*h/4-f),d=f>0?h-4:h;var i=0;for(b=0,c=0;d>b;b+=4,c+=3)e=j[a.charCodeAt(b)]<<18|j[a.charCodeAt(b+1)]<<12|j[a.charCodeAt(b+2)]<<6|j[a.charCodeAt(b+3)],g[i++]=e>>16&255,g[i++]=e>>8&255,g[i++]=255&e;return 2===f?(e=j[a.charCodeAt(b)]<<2|j[a.charCodeAt(b+1)]>>4,g[i++]=255&e):1===f&&(e=j[a.charCodeAt(b)]<<10|j[a.charCodeAt(b+1)]<<4|j[a.charCodeAt(b+2)]>>2,g[i++]=e>>8&255,g[i++]=255&e),g}function f(a){return i[a>>18&63]+i[a>>12&63]+i[a>>6&63]+i[63&a]}function g(a,b,c){for(var d,e=[],g=b;c>g;g+=3)d=(a[g]<<16)+(a[g+1]<<8)+a[g+2],e.push(f(d));return e.join("")}function h(a){for(var b,c=a.length,d=c%3,e="",f=[],h=16383,j=0,k=c-d;k>j;j+=h)f.push(g(a,j,j+h>k?k:j+h));return 1===d?(b=a[c-1],e+=i[b>>2],e+=i[b<<4&63],e+="=="):2===d&&(b=(a[c-2]<<8)+a[c-1],e+=i[b>>10],e+=i[b>>4&63],e+=i[b<<2&63],e+="="),f.push(e),f.join("")}c.toByteArray=e,c.fromByteArray=h;var i=[],j=[],k="undefined"!=typeof Uint8Array?Uint8Array:Array;d()},{}],3:[function(a,b,c){(function(b){"use strict";function d(){try{var a=new Uint8Array(1);return a.foo=function(){return 42},42===a.foo()&&"function"==typeof a.subarray&&0===a.subarray(1,1).byteLength}catch(b){return!1}}function e(){return g.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function f(a,b){if(e()<b)throw new RangeError("Invalid typed array length");return g.TYPED_ARRAY_SUPPORT?(a=new Uint8Array(b),a.__proto__=g.prototype):(null===a&&(a=new g(b)),a.length=b),a}function g(a,b,c){if(!(g.TYPED_ARRAY_SUPPORT||this instanceof g))return new g(a,b,c);if("number"==typeof a){if("string"==typeof b)throw new Error("If encoding is specified then the first argument must be a string");return k(this,a)}return h(this,a,b,c)}function h(a,b,c,d){if("number"==typeof b)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&b instanceof ArrayBuffer?n(a,b,c,d):"string"==typeof b?l(a,b,c):o(a,b)}function i(a){if("number"!=typeof a)throw new TypeError('"size" argument must be a number')}function j(a,b,c,d){return i(b),0>=b?f(a,b):void 0!==c?"string"==typeof d?f(a,b).fill(c,d):f(a,b).fill(c):f(a,b)}function k(a,b){if(i(b),a=f(a,0>b?0:0|p(b)),!g.TYPED_ARRAY_SUPPORT)for(var c=0;b>c;c++)a[c]=0;return a}function l(a,b,c){if("string"==typeof c&&""!==c||(c="utf8"),!g.isEncoding(c))throw new TypeError('"encoding" must be a valid string encoding');var d=0|r(b,c);return a=f(a,d),a.write(b,c),a}function m(a,b){var c=0|p(b.length);a=f(a,c);for(var d=0;c>d;d+=1)a[d]=255&b[d];return a}function n(a,b,c,d){if(b.byteLength,0>c||b.byteLength<c)throw new RangeError("'offset' is out of bounds");if(b.byteLength<c+(d||0))throw new RangeError("'length' is out of bounds");return b=void 0===d?new Uint8Array(b,c):new Uint8Array(b,c,d),g.TYPED_ARRAY_SUPPORT?(a=b,a.__proto__=g.prototype):a=m(a,b),a}function o(a,b){if(g.isBuffer(b)){var c=0|p(b.length);return a=f(a,c),0===a.length?a:(b.copy(a,0,0,c),a)}if(b){if("undefined"!=typeof ArrayBuffer&&b.buffer instanceof ArrayBuffer||"length"in b)return"number"!=typeof b.length||X(b.length)?f(a,0):m(a,b);if("Buffer"===b.type&&$(b.data))return m(a,b.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function p(a){if(a>=e())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+e().toString(16)+" bytes");return 0|a}function q(a){return+a!=a&&(a=0),g.alloc(+a)}function r(a,b){if(g.isBuffer(a))return a.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(a)||a instanceof ArrayBuffer))return a.byteLength;"string"!=typeof a&&(a=""+a);var c=a.length;if(0===c)return 0;for(var d=!1;;)switch(b){case"ascii":case"binary":case"raw":case"raws":return c;case"utf8":case"utf-8":case void 0:return S(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*c;case"hex":return c>>>1;case"base64":return V(a).length;default:if(d)return S(a).length;b=(""+b).toLowerCase(),d=!0}}function s(a,b,c){var d=!1;if((void 0===b||0>b)&&(b=0),b>this.length)return"";if((void 0===c||c>this.length)&&(c=this.length),0>=c)return"";if(c>>>=0,b>>>=0,b>=c)return"";for(a||(a="utf8");;)switch(a){case"hex":return G(this,b,c);case"utf8":case"utf-8":return C(this,b,c);case"ascii":return E(this,b,c);case"binary":return F(this,b,c);case"base64":return B(this,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return H(this,b,c);default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),d=!0}}function t(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function u(a,b,c,d){function e(a,b){return 1===f?a[b]:a.readUInt16BE(b*f)}var f=1,g=a.length,h=b.length;if(void 0!==d&&(d=String(d).toLowerCase(),"ucs2"===d||"ucs-2"===d||"utf16le"===d||"utf-16le"===d)){if(a.length<2||b.length<2)return-1;f=2,g/=2,h/=2,c/=2}for(var i=-1,j=0;g>c+j;j++)if(e(a,c+j)===e(b,-1===i?0:j-i)){if(-1===i&&(i=j),j-i+1===h)return(c+i)*f}else-1!==i&&(j-=j-i),i=-1;return-1}function v(a,b,c,d){c=Number(c)||0;var e=a.length-c;d?(d=Number(d),d>e&&(d=e)):d=e;var f=b.length;if(f%2!==0)throw new Error("Invalid hex string");d>f/2&&(d=f/2);for(var g=0;d>g;g++){var h=parseInt(b.substr(2*g,2),16);if(isNaN(h))return g;a[c+g]=h}return g}function w(a,b,c,d){return W(S(b,a.length-c),a,c,d)}function x(a,b,c,d){return W(T(b),a,c,d)}function y(a,b,c,d){return x(a,b,c,d)}function z(a,b,c,d){return W(V(b),a,c,d)}function A(a,b,c,d){return W(U(b,a.length-c),a,c,d)}function B(a,b,c){return 0===b&&c===a.length?Y.fromByteArray(a):Y.fromByteArray(a.slice(b,c))}function C(a,b,c){c=Math.min(a.length,c);for(var d=[],e=b;c>e;){var f=a[e],g=null,h=f>239?4:f>223?3:f>191?2:1;if(c>=e+h){var i,j,k,l;switch(h){case 1:128>f&&(g=f);break;case 2:i=a[e+1],128===(192&i)&&(l=(31&f)<<6|63&i,l>127&&(g=l));break;case 3:i=a[e+1],j=a[e+2],128===(192&i)&&128===(192&j)&&(l=(15&f)<<12|(63&i)<<6|63&j,l>2047&&(55296>l||l>57343)&&(g=l));break;case 4:i=a[e+1],j=a[e+2],k=a[e+3],128===(192&i)&&128===(192&j)&&128===(192&k)&&(l=(15&f)<<18|(63&i)<<12|(63&j)<<6|63&k,l>65535&&1114112>l&&(g=l))}}null===g?(g=65533,h=1):g>65535&&(g-=65536,d.push(g>>>10&1023|55296),g=56320|1023&g),d.push(g),e+=h}return D(d)}function D(a){var b=a.length;if(_>=b)return String.fromCharCode.apply(String,a);for(var c="",d=0;b>d;)c+=String.fromCharCode.apply(String,a.slice(d,d+=_));return c}function E(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;c>e;e++)d+=String.fromCharCode(127&a[e]);return d}function F(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;c>e;e++)d+=String.fromCharCode(a[e]);return d}function G(a,b,c){var d=a.length;(!b||0>b)&&(b=0),(!c||0>c||c>d)&&(c=d);for(var e="",f=b;c>f;f++)e+=R(a[f]);return e}function H(a,b,c){for(var d=a.slice(b,c),e="",f=0;f<d.length;f+=2)e+=String.fromCharCode(d[f]+256*d[f+1]);return e}function I(a,b,c){if(a%1!==0||0>a)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length")}function J(a,b,c,d,e,f){if(!g.isBuffer(a))throw new TypeError('"buffer" argument must be a Buffer instance');if(b>e||f>b)throw new RangeError('"value" argument is out of bounds');if(c+d>a.length)throw new RangeError("Index out of range")}function K(a,b,c,d){0>b&&(b=65535+b+1);for(var e=0,f=Math.min(a.length-c,2);f>e;e++)a[c+e]=(b&255<<8*(d?e:1-e))>>>8*(d?e:1-e)}function L(a,b,c,d){0>b&&(b=4294967295+b+1);for(var e=0,f=Math.min(a.length-c,4);f>e;e++)a[c+e]=b>>>8*(d?e:3-e)&255}function M(a,b,c,d,e,f){if(c+d>a.length)throw new RangeError("Index out of range");if(0>c)throw new RangeError("Index out of range")}function N(a,b,c,d,e){return e||M(a,b,c,4,3.4028234663852886e38,-3.4028234663852886e38),Z.write(a,b,c,d,23,4),c+4}function O(a,b,c,d,e){return e||M(a,b,c,8,1.7976931348623157e308,-1.7976931348623157e308),Z.write(a,b,c,d,52,8),c+8}function P(a){if(a=Q(a).replace(aa,""),a.length<2)return"";for(;a.length%4!==0;)a+="=";return a}function Q(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function R(a){return 16>a?"0"+a.toString(16):a.toString(16)}function S(a,b){b=b||1/0;for(var c,d=a.length,e=null,f=[],g=0;d>g;g++){if(c=a.charCodeAt(g),c>55295&&57344>c){if(!e){if(c>56319){(b-=3)>-1&&f.push(239,191,189);continue}if(g+1===d){(b-=3)>-1&&f.push(239,191,189);continue}e=c;continue}if(56320>c){(b-=3)>-1&&f.push(239,191,189),e=c;continue}c=(e-55296<<10|c-56320)+65536}else e&&(b-=3)>-1&&f.push(239,191,189);if(e=null,128>c){if((b-=1)<0)break;f.push(c)}else if(2048>c){if((b-=2)<0)break;f.push(c>>6|192,63&c|128)}else if(65536>c){if((b-=3)<0)break;f.push(c>>12|224,c>>6&63|128,63&c|128)}else{if(!(1114112>c))throw new Error("Invalid code point");if((b-=4)<0)break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}}return f}function T(a){for(var b=[],c=0;c<a.length;c++)b.push(255&a.charCodeAt(c));return b}function U(a,b){for(var c,d,e,f=[],g=0;g<a.length&&!((b-=2)<0);g++)c=a.charCodeAt(g),d=c>>8,e=c%256,f.push(e),f.push(d);return f}function V(a){return Y.toByteArray(P(a))}function W(a,b,c,d){for(var e=0;d>e&&!(e+c>=b.length||e>=a.length);e++)b[e+c]=a[e];return e}function X(a){return a!==a}var Y=a("base64-js"),Z=a("ieee754"),$=a("isarray");c.Buffer=g,c.SlowBuffer=q,c.INSPECT_MAX_BYTES=50,g.TYPED_ARRAY_SUPPORT=void 0!==b.TYPED_ARRAY_SUPPORT?b.TYPED_ARRAY_SUPPORT:d(),c.kMaxLength=e(),g.poolSize=8192,g._augment=function(a){return a.__proto__=g.prototype,a},g.from=function(a,b,c){return h(null,a,b,c)},g.TYPED_ARRAY_SUPPORT&&(g.prototype.__proto__=Uint8Array.prototype,g.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&g[Symbol.species]===g&&Object.defineProperty(g,Symbol.species,{value:null,configurable:!0})),g.alloc=function(a,b,c){return j(null,a,b,c)},g.allocUnsafe=function(a){return k(null,a)},g.allocUnsafeSlow=function(a){return k(null,a)},g.isBuffer=function(a){return!(null==a||!a._isBuffer)},g.compare=function(a,b){if(!g.isBuffer(a)||!g.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var c=a.length,d=b.length,e=0,f=Math.min(c,d);f>e;++e)if(a[e]!==b[e]){c=a[e],d=b[e];break}return d>c?-1:c>d?1:0},g.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},g.concat=function(a,b){if(!$(a))throw new TypeError('"list" argument must be an Array of Buffers');if(0===a.length)return g.alloc(0);var c;if(void 0===b)for(b=0,c=0;c<a.length;c++)b+=a[c].length;var d=g.allocUnsafe(b),e=0;for(c=0;c<a.length;c++){var f=a[c];if(!g.isBuffer(f))throw new TypeError('"list" argument must be an Array of Buffers');f.copy(d,e),e+=f.length}return d},g.byteLength=r,g.prototype._isBuffer=!0,g.prototype.swap16=function(){var a=this.length;if(a%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var b=0;a>b;b+=2)t(this,b,b+1);return this},g.prototype.swap32=function(){var a=this.length;if(a%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var b=0;a>b;b+=4)t(this,b,b+3),t(this,b+1,b+2);return this},g.prototype.toString=function(){var a=0|this.length;return 0===a?"":0===arguments.length?C(this,0,a):s.apply(this,arguments)},g.prototype.equals=function(a){if(!g.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?!0:0===g.compare(this,a)},g.prototype.inspect=function(){var a="",b=c.INSPECT_MAX_BYTES;return this.length>0&&(a=this.toString("hex",0,b).match(/.{2}/g).join(" "),this.length>b&&(a+=" ... ")),"<Buffer "+a+">"},g.prototype.compare=function(a,b,c,d,e){if(!g.isBuffer(a))throw new TypeError("Argument must be a Buffer");if(void 0===b&&(b=0),void 0===c&&(c=a?a.length:0),void 0===d&&(d=0),void 0===e&&(e=this.length),0>b||c>a.length||0>d||e>this.length)throw new RangeError("out of range index");if(d>=e&&b>=c)return 0;if(d>=e)return-1;if(b>=c)return 1;if(b>>>=0,c>>>=0,d>>>=0,e>>>=0,this===a)return 0;for(var f=e-d,h=c-b,i=Math.min(f,h),j=this.slice(d,e),k=a.slice(b,c),l=0;i>l;++l)if(j[l]!==k[l]){f=j[l],h=k[l];break}return h>f?-1:f>h?1:0},g.prototype.indexOf=function(a,b,c){if("string"==typeof b?(c=b,b=0):b>2147483647?b=2147483647:-2147483648>b&&(b=-2147483648),b>>=0,0===this.length)return-1;if(b>=this.length)return-1;if(0>b&&(b=Math.max(this.length+b,0)),"string"==typeof a&&(a=g.from(a,c)),g.isBuffer(a))return 0===a.length?-1:u(this,a,b,c);if("number"==typeof a)return g.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,a,b):u(this,[a],b,c);throw new TypeError("val must be string, number or Buffer")},g.prototype.includes=function(a,b,c){return-1!==this.indexOf(a,b,c)},g.prototype.write=function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"==typeof b)d=b,c=this.length,b=0;else{if(!isFinite(b))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");b=0|b,isFinite(c)?(c=0|c,void 0===d&&(d="utf8")):(d=c,c=void 0)}var e=this.length-b;if((void 0===c||c>e)&&(c=e),a.length>0&&(0>c||0>b)||b>this.length)throw new RangeError("Attempt to write outside buffer bounds");d||(d="utf8");for(var f=!1;;)switch(d){case"hex":return v(this,a,b,c);case"utf8":case"utf-8":return w(this,a,b,c);case"ascii":return x(this,a,b,c);case"binary":return y(this,a,b,c);case"base64":return z(this,a,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,a,b,c);default:if(f)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),f=!0}},g.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var _=4096;g.prototype.slice=function(a,b){var c=this.length;a=~~a,b=void 0===b?c:~~b,0>a?(a+=c,0>a&&(a=0)):a>c&&(a=c),0>b?(b+=c,0>b&&(b=0)):b>c&&(b=c),a>b&&(b=a);var d;if(g.TYPED_ARRAY_SUPPORT)d=this.subarray(a,b),d.__proto__=g.prototype;else{var e=b-a;d=new g(e,void 0);for(var f=0;e>f;f++)d[f]=this[f+a]}return d},g.prototype.readUIntLE=function(a,b,c){a=0|a,b=0|b,c||I(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return d},g.prototype.readUIntBE=function(a,b,c){a=0|a,b=0|b,c||I(a,b,this.length);for(var d=this[a+--b],e=1;b>0&&(e*=256);)d+=this[a+--b]*e;return d},g.prototype.readUInt8=function(a,b){return b||I(a,1,this.length),this[a]},g.prototype.readUInt16LE=function(a,b){return b||I(a,2,this.length),this[a]|this[a+1]<<8},g.prototype.readUInt16BE=function(a,b){return b||I(a,2,this.length),this[a]<<8|this[a+1]},g.prototype.readUInt32LE=function(a,b){return b||I(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},g.prototype.readUInt32BE=function(a,b){return b||I(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},g.prototype.readIntLE=function(a,b,c){a=0|a,b=0|b,c||I(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return e*=128,d>=e&&(d-=Math.pow(2,8*b)),d},g.prototype.readIntBE=function(a,b,c){a=0|a,b=0|b,c||I(a,b,this.length);for(var d=b,e=1,f=this[a+--d];d>0&&(e*=256);)f+=this[a+--d]*e;return e*=128,f>=e&&(f-=Math.pow(2,8*b)),f},g.prototype.readInt8=function(a,b){return b||I(a,1,this.length),128&this[a]?-1*(255-this[a]+1):this[a]},g.prototype.readInt16LE=function(a,b){b||I(a,2,this.length);var c=this[a]|this[a+1]<<8;return 32768&c?4294901760|c:c},g.prototype.readInt16BE=function(a,b){b||I(a,2,this.length);var c=this[a+1]|this[a]<<8;return 32768&c?4294901760|c:c},g.prototype.readInt32LE=function(a,b){return b||I(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},g.prototype.readInt32BE=function(a,b){return b||I(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},g.prototype.readFloatLE=function(a,b){return b||I(a,4,this.length),Z.read(this,a,!0,23,4)},g.prototype.readFloatBE=function(a,b){return b||I(a,4,this.length),Z.read(this,a,!1,23,4)},g.prototype.readDoubleLE=function(a,b){return b||I(a,8,this.length),Z.read(this,a,!0,52,8)},g.prototype.readDoubleBE=function(a,b){return b||I(a,8,this.length),Z.read(this,a,!1,52,8)},g.prototype.writeUIntLE=function(a,b,c,d){if(a=+a,b=0|b,c=0|c,!d){var e=Math.pow(2,8*c)-1;J(this,a,b,c,e,0)}var f=1,g=0;for(this[b]=255&a;++g<c&&(f*=256);)this[b+g]=a/f&255;return b+c},g.prototype.writeUIntBE=function(a,b,c,d){if(a=+a,b=0|b,c=0|c,!d){var e=Math.pow(2,8*c)-1;J(this,a,b,c,e,0)}var f=c-1,g=1;for(this[b+f]=255&a;--f>=0&&(g*=256);)this[b+f]=a/g&255;return b+c},g.prototype.writeUInt8=function(a,b,c){return a=+a,b=0|b,c||J(this,a,b,1,255,0),g.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),this[b]=255&a,b+1},g.prototype.writeUInt16LE=function(a,b,c){return a=+a,b=0|b,c||J(this,a,b,2,65535,0),g.TYPED_ARRAY_SUPPORT?(this[b]=255&a,this[b+1]=a>>>8):K(this,a,b,!0),b+2},g.prototype.writeUInt16BE=function(a,b,c){return a=+a,b=0|b,c||J(this,a,b,2,65535,0),g.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=255&a):K(this,a,b,!1),b+2},g.prototype.writeUInt32LE=function(a,b,c){return a=+a,b=0|b,c||J(this,a,b,4,4294967295,0),g.TYPED_ARRAY_SUPPORT?(this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=255&a):L(this,a,b,!0),b+4},g.prototype.writeUInt32BE=function(a,b,c){return a=+a,b=0|b,c||J(this,a,b,4,4294967295,0),g.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a):L(this,a,b,!1),b+4},g.prototype.writeIntLE=function(a,b,c,d){if(a=+a,b=0|b,!d){var e=Math.pow(2,8*c-1);J(this,a,b,c,e-1,-e)}var f=0,g=1,h=0;for(this[b]=255&a;++f<c&&(g*=256);)0>a&&0===h&&0!==this[b+f-1]&&(h=1),this[b+f]=(a/g>>0)-h&255;return b+c},g.prototype.writeIntBE=function(a,b,c,d){if(a=+a,b=0|b,!d){var e=Math.pow(2,8*c-1);J(this,a,b,c,e-1,-e)}var f=c-1,g=1,h=0;for(this[b+f]=255&a;--f>=0&&(g*=256);)0>a&&0===h&&0!==this[b+f+1]&&(h=1),this[b+f]=(a/g>>0)-h&255;return b+c},g.prototype.writeInt8=function(a,b,c){return a=+a,b=0|b,c||J(this,a,b,1,127,-128),g.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),0>a&&(a=255+a+1),this[b]=255&a,b+1},g.prototype.writeInt16LE=function(a,b,c){return a=+a,b=0|b,c||J(this,a,b,2,32767,-32768),g.TYPED_ARRAY_SUPPORT?(this[b]=255&a,this[b+1]=a>>>8):K(this,a,b,!0),b+2},g.prototype.writeInt16BE=function(a,b,c){return a=+a,b=0|b,c||J(this,a,b,2,32767,-32768),g.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=255&a):K(this,a,b,!1),b+2},g.prototype.writeInt32LE=function(a,b,c){return a=+a,b=0|b,c||J(this,a,b,4,2147483647,-2147483648),g.TYPED_ARRAY_SUPPORT?(this[b]=255&a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24):L(this,a,b,!0),b+4},g.prototype.writeInt32BE=function(a,b,c){return a=+a,b=0|b,c||J(this,a,b,4,2147483647,-2147483648),0>a&&(a=4294967295+a+1),g.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a):L(this,a,b,!1),b+4},g.prototype.writeFloatLE=function(a,b,c){return N(this,a,b,!0,c)},g.prototype.writeFloatBE=function(a,b,c){return N(this,a,b,!1,c)},g.prototype.writeDoubleLE=function(a,b,c){return O(this,a,b,!0,c)},g.prototype.writeDoubleBE=function(a,b,c){return O(this,a,b,!1,c)},g.prototype.copy=function(a,b,c,d){if(c||(c=0),d||0===d||(d=this.length),b>=a.length&&(b=a.length),b||(b=0),d>0&&c>d&&(d=c),d===c)return 0;if(0===a.length||0===this.length)return 0;if(0>b)throw new RangeError("targetStart out of bounds");if(0>c||c>=this.length)throw new RangeError("sourceStart out of bounds");if(0>d)throw new RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length),a.length-b<d-c&&(d=a.length-b+c);var e,f=d-c;if(this===a&&b>c&&d>b)for(e=f-1;e>=0;e--)a[e+b]=this[e+c];else if(1e3>f||!g.TYPED_ARRAY_SUPPORT)for(e=0;f>e;e++)a[e+b]=this[e+c];else Uint8Array.prototype.set.call(a,this.subarray(c,c+f),b);return f},g.prototype.fill=function(a,b,c,d){if("string"==typeof a){if("string"==typeof b?(d=b,b=0,c=this.length):"string"==typeof c&&(d=c,c=this.length),1===a.length){var e=a.charCodeAt(0);256>e&&(a=e)}if(void 0!==d&&"string"!=typeof d)throw new TypeError("encoding must be a string");if("string"==typeof d&&!g.isEncoding(d))throw new TypeError("Unknown encoding: "+d)}else"number"==typeof a&&(a=255&a);if(0>b||this.length<b||this.length<c)throw new RangeError("Out of range index");if(b>=c)return this;b>>>=0,c=void 0===c?this.length:c>>>0,a||(a=0);var f;if("number"==typeof a)for(f=b;c>f;f++)this[f]=a;else{var h=g.isBuffer(a)?a:S(new g(a,d).toString()),i=h.length;for(f=0;c-b>f;f++)this[f+b]=h[f%i]}return this};var aa=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":2,ieee754:5,isarray:6}],4:[function(a,b,c){function d(){}Object.assign(d.prototype,{addEventListener:function(a,b){this._listeners||Object.defineProperty(this,"_listeners",{value:{}});var c=this._listeners,d=c[a];void 0===d&&(c[a]=d=[]),d.some(function(a){return a===b})||d.push(b)},dispatchEvent:function(a){this._listeners||Object.defineProperty(this,"_listeners",{value:{}});var b=this._listeners;if(a._dispatched)throw new DOMException("The object is in an invalid state.","InvalidStateError");a._dispatched=!0;var c=a.type;if(void 0==c||""==c)throw new DOMException("UNSPECIFIED_EVENT_TYPE_ERR","UNSPECIFIED_EVENT_TYPE_ERR");var d=b[c].concat()||[],e=this["on"+c],f=d.length?1:0,g=!1;return a.cancelable=!0,a.defaultPrevented=!1,a.isTrusted=!1,a.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},a.stopImmediatePropagation=function(){g=!0},a.target=this,a.timeStamp=(new Date).getTime(),d.some(function(b,c){return g?!0:(c===f&&"function"==typeof e&&e.call(this,a),void b.call(this,a))},this),"function"==typeof e&&d.length<2&&e.call(this,a),!a.defaultPrevented},hasEventListener:function(a,b){this._listeners||Object.defineProperty(this,"_listeners",{value:{}});var c=this._listeners;return void 0!==c[a]&&-1!==c[a].indexOf(b)},removeEventListener:function(a,b){this._listeners||Object.defineProperty(this,"_listeners",{value:{}});var c=this._listeners,d=c[a];void 0!==d&&(d.some(function(a,c){return a===b?(d.splice(c,1),!0):void 0}),d.length||delete c[a])}}),"undefined"!=typeof b&&b.exports&&(b.exports=d)},{}],5:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:(n?-1:1)*(1/0);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=0>b||0===b&&0>1/b?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],6:[function(a,b,c){var d={}.toString;b.exports=Array.isArray||function(a){return"[object Array]"==d.call(a)}},{}],7:[function(a,b,c){(function(a){"use strict";b.exports=a.openDatabase}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(a,b,c){"use strict";function d(a,b){var c=new DOMException.prototype.constructor(0,b);return c.name=a||"DOMException",c.message=b,c}function e(a,b){a=a||"DOMError";var c=new DOMError(a,b);return c.name===a||(c.name=a),c.message===b||(c.message=b),c}function f(a,b){var c=new Error(b);return c.name=a||"DOMException",c.message=b,c}function g(a,b,c){if(i.DEBUG){c&&c.message&&(c=c.message);var d="function"==typeof console.error?"error":"log";console[d](a+": "+b+". "+(c||"")),console.trace&&console.trace()}}function h(a){var b=void 0;if(a){if(1===a.length)return a[0];for(var c=0;c<a.length;c++){var d=a[c];if(d instanceof Error||d instanceof DOMException)return d;d&&"string"==typeof d.message&&(b=d)}}return b}Object.defineProperty(c,"__esModule",{value:!0});var i="undefined"!=typeof window?window:GLOBAL,j=void 0,k=!1,l=!1;try{j=d("test name","test message"),j instanceof DOMException&&"test name"===j.name&&"test message"===j.message&&(k=!0)}catch(m){}try{j=e("test name","test message"),j instanceof DOMError&&"test name"===j.name&&"test message"===j.message&&(l=!0)}catch(m){}var n=void 0,o=void 0;k?(c.DOMException=o=DOMException,c.createDOMException=n=function(a,b,c){return g(a,b,c),d(a,b)}):(c.DOMException=o=Error,c.createDOMException=n=function(a,b,c){return g(a,b,c),f(a,b)});var p=void 0,q=void 0;l?(c.DOMError=q=DOMError,c.createDOMError=p=function(a,b,c){return g(a,b,c),e(a,b)}):(c.DOMError=q=Error,c.createDOMError=p=function(a,b,c){return g(a,b,c),f(a,b)}),c.logError=g,c.findError=h,c.DOMError=q,c.DOMException=o,c.createDOMException=n,c.createDOMError=p},{}],9:[function(a,b,c){"use strict";function d(a,b){var c=new Event(a);return c.debug=b,Object.defineProperty(c,"target",{writable:!0}),c}function e(a,b){this.type=a,this.debug=b,this.bubbles=!1,this.cancelable=!1,this.eventPhase=0,this.timeStamp=(new Date).valueOf()}Object.defineProperty(c,"__esModule",{value:!0});var f=!1;try{var g=d("test type","test debug"),h={test:"test target"};g.target=h,g instanceof Event&&"test type"===g.type&&"test debug"===g.debug&&g.target===h&&(f=!0)}catch(i){}var j=void 0,k=void 0,l=void 0;f?(c.Event=j=Event,c.IDBVersionChangeEvent=l=Event,c.createEvent=k=d):(c.Event=j=e,c.IDBVersionChangeEvent=l=e,c.createEvent=k=function(a,b){return new e(a,b)}),c.Event=j,c.IDBVersionChangeEvent=l,c.createEvent=k},{}],10:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c,d,e,f,h){if(null===a&&(a=void 0),void 0===a||a instanceof m["default"]||(a=new m["default"](a,a,!1,!1)),c.transaction.__assertActive(),void 0!==b&&-1===["next","prev","nextunique","prevunique"].indexOf(b))throw new TypeError(b+"is not a valid cursor direction");this.source=d,this.direction=b||"next",this.key=void 0,this.primaryKey=void 0,this.__store=c,this.__range=a,this.__req=new g.IDBRequest,this.__keyColumnName=e,this.__valueColumnName=f,this.__valueDecoder="value"===f?o["default"]:k["default"],this.__count=h,this.__offset=-1,this.__lastKeyContinued=void 0,this.__multiEntryIndex=d instanceof q["default"]?d.multiEntry:!1,this.__unique=-1!==this.direction.indexOf("unique"),void 0!==a&&(a.__lower=void 0!==a.lower&&k["default"].encode(a.lower,this.__multiEntryIndex),a.__upper=void 0!==a.upper&&k["default"].encode(a.upper,this.__multiEntryIndex)),this["continue"]()}Object.defineProperty(c,"__esModule",{value:!0}),c.IDBCursorWithValue=c.IDBCursor=void 0;var f=a("./DOMException.js"),g=a("./IDBRequest.js"),h=a("./util.js"),i=d(h),j=a("./Key.js"),k=d(j),l=a("./IDBKeyRange.js"),m=d(l),n=a("./Sca.js"),o=d(n),p=a("./IDBIndex.js"),q=d(p),r="undefined"!=typeof window?window:GLOBAL;e.prototype.__find=function(){var a=Array.prototype.slice.call(arguments);this.__multiEntryIndex?this.__findMultiEntry.apply(this,a):this.__findBasic.apply(this,a)},e.prototype.__findBasic=function(a,b,c,d,e){e=e||1;var f=this,g=i["default"].quote(f.__keyColumnName),h=["SELECT * FROM",i["default"].quote(f.__store.name)],j=[];h.push("WHERE",g,"NOT NULL"),!f.__range||void 0===f.__range.lower&&void 0===f.__range.upper||(h.push("AND"),void 0!==f.__range.lower&&(h.push(g,f.__range.lowerOpen?">":">=","?"),j.push(f.__range.__lower)),void 0!==f.__range.lower&&void 0!==f.__range.upper&&h.push("AND"),void 0!==f.__range.upper&&(h.push(g,f.__range.upperOpen?"<":"<=","?"),j.push(f.__range.__upper))),"undefined"!=typeof a&&(f.__lastKeyContinued=a,f.__offset=0),void 0!==f.__lastKeyContinued&&(h.push("AND",g,">= ?"),k["default"].validate(f.__lastKeyContinued),j.push(k["default"].encode(f.__lastKeyContinued)));var l="prev"===f.direction||"prevunique"===f.direction?"DESC":"ASC";f.__count||(h.push("ORDER BY",g,l),h.push("LIMIT",e,"OFFSET",f.__offset)),h=h.join(" "),r.DEBUG&&console.log(h,j),f.__prefetchedData=null,f.__prefetchedIndex=0,b.executeSql(h,j,function(a,b){f.__count?c(void 0,b.rows.length,void 0):b.rows.length>1?(f.__prefetchedData=b.rows,f.__prefetchedIndex=0,r.DEBUG&&console.log("Preloaded "+f.__prefetchedData.length+" records for cursor"),f.__decode(b.rows.item(0),c)):1===b.rows.length?f.__decode(b.rows.item(0),c):(r.DEBUG&&console.log("Reached end of cursors"),c(void 0,void 0,void 0))},function(a,b){r.DEBUG&&console.log("Could not execute Cursor.continue",h,j),d(b)})},e.prototype.__findMultiEntry=function(a,b,c,d){var e=this;if(e.__prefetchedData&&e.__prefetchedData.length===e.__prefetchedIndex)return r.DEBUG&&console.log("Reached end of multiEntry cursor"),void c(void 0,void 0,void 0);var f=i["default"].quote(e.__keyColumnName),g=["SELECT * FROM",i["default"].quote(e.__store.name)],h=[];g.push("WHERE",f,"NOT NULL"),e.__range&&void 0!==e.__range.lower&&void 0!==e.__range.upper&&0===e.__range.upper.indexOf(e.__range.lower)&&(g.push("AND",f,"LIKE ?"),h.push("%"+e.__range.__lower.slice(0,-1)+"%")),"undefined"!=typeof a&&(e.__lastKeyContinued=a,e.__offset=0),void 0!==e.__lastKeyContinued&&(g.push("AND",f,">= ?"),k["default"].validate(e.__lastKeyContinued),h.push(k["default"].encode(e.__lastKeyContinued)));var j="prev"===e.direction||"prevunique"===e.direction?"DESC":"ASC";e.__count||g.push("ORDER BY key",j),g=g.join(" "),r.DEBUG&&console.log(g,h),e.__prefetchedData=null,e.__prefetchedIndex=0,b.executeSql(g,h,function(a,b){e.__multiEntryOffset=b.rows.length,b.rows.length>0?!function(){for(var a=[],d=0;d<b.rows.length;d++)for(var f=b.rows.item(d),g=k["default"].decode(f[e.__keyColumnName],!0),h=k["default"].findMultiEntryMatches(g,e.__range),i=0;i<h.length;i++){var j=h[i],l={matchingKey:k["default"].encode(j,!0),key:f.key};l[e.__keyColumnName]=f[e.__keyColumnName],l[e.__valueColumnName]=f[e.__valueColumnName],a.push(l)}var m=0===e.direction.indexOf("prev");a.sort(function(a,b){return a.matchingKey.replace("[","z")<b.matchingKey.replace("[","z")?m?1:-1:a.matchingKey.replace("[","z")>b.matchingKey.replace("[","z")?m?-1:1:a.key<b.key?"prev"===e.direction?1:-1:a.key>b.key?"prev"===e.direction?-1:1:0}),e.__prefetchedData={data:a,length:a.length,item:function(a){return this.data[a]}},e.__prefetchedIndex=0,e.__count?c(void 0,a.length,void 0):a.length>1?(r.DEBUG&&console.log("Preloaded "+e.__prefetchedData.length+" records for multiEntry cursor"),e.__decode(a[0],c)):1===a.length?(r.DEBUG&&console.log("Reached end of multiEntry cursor"),e.__decode(a[0],c)):(r.DEBUG&&console.log("Reached end of multiEntry cursor"),c(void 0,void 0,void 0))}():(r.DEBUG&&console.log("Reached end of multiEntry cursor"),c(void 0,void 0,void 0))},function(a,b){r.DEBUG&&console.log("Could not execute Cursor.continue",g,h),d(b)})},e.prototype.__onsuccess=function(a){var b=this;return function(c,d,e){if(b.__count)a(d,b.__req);else{b.key=void 0===c?null:c,b.value=void 0===d?null:d,b.primaryKey=void 0===e?null:e;var f=void 0===c?null:b;a(f,b.__req);
}}},e.prototype.__decode=function(a,b){if(this.__multiEntryIndex&&this.__unique){if(this.__matchedKeys||(this.__matchedKeys={}),this.__matchedKeys[a.matchingKey])return void b(void 0,void 0,void 0);this.__matchedKeys[a.matchingKey]=!0}var c=k["default"].decode(this.__multiEntryIndex?a.matchingKey:a[this.__keyColumnName],this.__multiEntryIndex),d=this.__valueDecoder.decode(a[this.__valueColumnName]),e=k["default"].decode(a.key);b(c,d,e)},e.prototype["continue"]=function(a){var b=r.cursorPreloadPackSize||100,c=this;this.__store.transaction.__pushToQueue(c.__req,function(d,e,f,g){return c.__offset++,c.__prefetchedData&&(c.__prefetchedIndex++,c.__prefetchedIndex<c.__prefetchedData.length)?void c.__decode(c.__prefetchedData.item(c.__prefetchedIndex),c.__onsuccess(f)):void c.__find(a,d,c.__onsuccess(f),g,b)})},e.prototype.advance=function(a){if(0>=a)throw(0,f.createDOMException)("Type Error","Count is invalid - 0 or negative",a);var b=this;this.__store.transaction.__pushToQueue(b.__req,function(c,d,e,f){b.__offset+=a,b.__find(void 0,c,b.__onsuccess(e),f)})},e.prototype.update=function(a){var b=this;return b.__store.transaction.__assertWritable(),b.__store.transaction.__addToTransactionQueue(function(c,d,e,f){o["default"].encode(a,function(d){b.__find(void 0,c,function(g,h,j){var l=b.__store,m=[d],n=["UPDATE",i["default"].quote(l.name),"SET value = ?"];k["default"].validate(j);for(var o=0;o<l.indexNames.length;o++){var p=l.__indexes[l.indexNames[o]],q=k["default"].getValue(a,p.keyPath);n.push(",",i["default"].quote(p.name),"= ?"),m.push(k["default"].encode(q,p.multiEntry))}n.push("WHERE key = ?"),m.push(k["default"].encode(j)),r.DEBUG&&console.log(n.join(" "),d,g,j),c.executeSql(n.join(" "),m,function(a,c){b.__prefetchedData=null,b.__prefetchedIndex=0,1===c.rowsAffected?e(g):f("No rows with key found"+g)},function(a,b){f(b)})},f)})})},e.prototype["delete"]=function(){var a=this;return a.__store.transaction.__assertWritable(),this.__store.transaction.__addToTransactionQueue(function(b,c,d,e){a.__find(void 0,b,function(c,f,g){var h="DELETE FROM  "+i["default"].quote(a.__store.name)+" WHERE key = ?";r.DEBUG&&console.log(h,c,g),k["default"].validate(g),b.executeSql(h,[k["default"].encode(g)],function(b,f){a.__prefetchedData=null,a.__prefetchedIndex=0,1===f.rowsAffected?(a.__offset--,d(void 0)):e("No rows with key found"+c)},function(a,b){e(b)})},e)})};var s={};c.IDBCursor=e,c.IDBCursorWithValue=s},{"./DOMException.js":8,"./IDBIndex.js":13,"./IDBKeyRange.js":14,"./IDBRequest.js":16,"./Key.js":18,"./Sca.js":19,"./util.js":21}],11:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c,d){this.__db=a,this.__closed=!1,this.version=c,this.name=b,this.onabort=this.onerror=this.onversionchange=null,this.__objectStores={},this.objectStoreNames=new h["default"].StringList;for(var e=0;e<d.rows.length;e++){var f=new j["default"](d.rows.item(e));this.__objectStores[f.name]=f,this.objectStoreNames.push(f.name)}}Object.defineProperty(c,"__esModule",{value:!0});var f=a("./DOMException.js"),g=a("./util.js"),h=d(g),i=a("./IDBObjectStore.js"),j=d(i),k=a("./IDBTransaction.js"),l=d(k),m="undefined"!=typeof window?window:GLOBAL;e.prototype.createObjectStore=function(a,b){if(0===arguments.length)throw new TypeError("No object store name was specified");if(this.__objectStores[a])throw(0,f.createDOMException)("ConstraintError",'Object store "'+a+'" already exists in '+this.name);this.__versionTransaction.__assertVersionChange(),b=b||{};var c={name:a,keyPath:JSON.stringify(b.keyPath||null),autoInc:JSON.stringify(b.autoIncrement),indexList:"{}"},d=new j["default"](c,this.__versionTransaction);return j["default"].__createObjectStore(this,d),d},e.prototype.deleteObjectStore=function(a){if(0===arguments.length)throw new TypeError("No object store name was specified");var b=this.__objectStores[a];if(!b)throw(0,f.createDOMException)("NotFoundError",'Object store "'+a+'" does not exist in '+this.name);this.__versionTransaction.__assertVersionChange(),j["default"].__deleteObjectStore(this,b)},e.prototype.close=function(){this.__closed=!0},e.prototype.transaction=function(a,b){if(this.__closed)throw(0,f.createDOMException)("InvalidStateError","An attempt was made to start a new transaction on a database connection that is not open");if("number"==typeof b?(b=1===b?l["default"].READ_WRITE:l["default"].READ_ONLY,m.DEBUG&&console.log("Mode should be a string, but was specified as ",b)):b=b||l["default"].READ_ONLY,b!==l["default"].READ_ONLY&&b!==l["default"].READ_WRITE)throw new TypeError("Invalid transaction mode: "+b);if(a="string"==typeof a?[a]:a,0===a.length)throw(0,f.createDOMException)("InvalidAccessError","No object store names were specified");for(var c=0;c<a.length;c++)if(!this.objectStoreNames.contains(a[c]))throw(0,f.createDOMException)("NotFoundError",'The "'+a[c]+'" object store does not exist');var d=new l["default"](this,a,b);return d},c["default"]=e},{"./DOMException.js":8,"./IDBObjectStore.js":15,"./IDBTransaction.js":17,"./util.js":21}],12:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){function c(a,c){c=(0,i.findError)(arguments),s.DEBUG&&console.log("Error in sysdb transaction - when creating dbVersions",c),b(c)}v?a():(v=t("__sysdb__",1,"System Database",u),v.transaction(function(b){b.executeSql("CREATE TABLE IF NOT EXISTS dbVersions (name VARCHAR(255), version INT);",[],a,c)},c))}function f(){}Object.defineProperty(c,"__esModule",{value:!0}),c.shimIndexedDB=c.IDBFactory=void 0;var g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a},h=a("./Event.js"),i=a("./DOMException.js"),j=a("./IDBRequest.js"),k=a("./util.js"),l=d(k),m=a("./Key.js"),n=d(m),o=a("./IDBTransaction.js"),p=d(o),q=a("./IDBDatabase.js"),r=d(q),s="undefined"!=typeof window?window:GLOBAL,t="undefined"==typeof s.nodeWebsql?window.openDatabase:s.nodeWebsql,u=4194304,v=void 0;f.prototype.open=function(a,b){function c(a,b){if(!g){b=(0,i.findError)(arguments),g=!0;var c=(0,h.createEvent)("error",arguments);f.readyState="done",f.error=b||i.DOMError,l["default"].callback("onerror",f,c)}}function d(d){var e=t(a,1,a,u);if(f.readyState="done","undefined"==typeof b&&(b=d||1),0>=b||d>b){var g=(0,i.createDOMError)("VersionError","An attempt was made to open a database using a lower version than the existing version.",b);return void c(g)}e.transaction(function(g){g.executeSql("CREATE TABLE IF NOT EXISTS __sys__ (name VARCHAR(255), keyPath VARCHAR(255), autoInc BOOLEAN, indexList BLOB)",[],function(){g.executeSql("SELECT * FROM __sys__",[],function(g,i){var j=(0,h.createEvent)("success");f.source=f.result=new r["default"](e,a,b,i),b>d?v.transaction(function(e){e.executeSql("UPDATE dbVersions set version = ? where name = ?",[b,a],function(){var a=(0,h.createEvent)("upgradeneeded");a.oldVersion=d,a.newVersion=b,f.transaction=f.result.__versionTransaction=new p["default"](f.source,[],p["default"].VERSION_CHANGE),f.transaction.__addToTransactionQueue(function(b,c,d){l["default"].callback("onupgradeneeded",f,a),d()}),f.transaction.__oncomplete=function(){f.transaction=null;var a=(0,h.createEvent)("success");l["default"].callback("onsuccess",f,a)}},c)},c):l["default"].callback("onsuccess",f,j)},c)},c)},c)}var f=new j.IDBOpenDBRequest,g=!1;if(0===arguments.length)throw new TypeError("Database name is required");if(2===arguments.length&&(b=parseFloat(b),isNaN(b)||!isFinite(b)||0>=b))throw new TypeError("Invalid database version: "+b);return a+="",e(function(){v.transaction(function(e){e.executeSql("SELECT * FROM dbVersions where name = ?",[a],function(e,f){0===f.rows.length?e.executeSql("INSERT INTO dbVersions VALUES (?,?)",[a,b||1],function(){d(0)},c):d(f.rows.item(0).version)},c)},c)},c),f},f.prototype.deleteDatabase=function(a){function b(a,b){if(!f){b=(0,i.findError)(arguments),d.readyState="done",d.error=b||i.DOMError;var c=(0,h.createEvent)("error");c.debug=arguments,l["default"].callback("onerror",d,c),f=!0}}function c(){v.transaction(function(c){c.executeSql("DELETE FROM dbVersions where name = ? ",[a],function(){d.result=void 0;var a=(0,h.createEvent)("success");a.newVersion=null,a.oldVersion=g,l["default"].callback("onsuccess",d,a)},b)},b)}var d=new j.IDBOpenDBRequest,f=!1,g=null;if(0===arguments.length)throw new TypeError("Database name is required");return a+="",e(function(){v.transaction(function(e){e.executeSql("SELECT * FROM dbVersions where name = ?",[a],function(e,f){if(0===f.rows.length){d.result=void 0;var i=(0,h.createEvent)("success");return i.newVersion=null,i.oldVersion=g,void l["default"].callback("onsuccess",d,i)}g=f.rows.item(0).version;var j=t(a,1,a,u);j.transaction(function(a){a.executeSql("SELECT * FROM __sys__",[],function(a,d){var e=d.rows;!function f(d){d>=e.length?a.executeSql("DROP TABLE IF EXISTS __sys__",[],function(){c()},b):a.executeSql("DROP TABLE "+l["default"].quote(e.item(d).name),[],function(){f(d+1)},function(){f(d+1)})}(0)},function(a){c()})})},b)},b)},b),d},f.prototype.cmp=function(a,b){if(arguments.length<2)throw new TypeError("You must provide two keys to be compared");n["default"].validate(a),n["default"].validate(b);var c=n["default"].encode(a),d=n["default"].encode(b),e=c>d?1:c===d?0:-1;if(s.DEBUG){var f=n["default"].decode(c),h=n["default"].decode(d);"object"===("undefined"==typeof a?"undefined":g(a))&&(a=JSON.stringify(a),f=JSON.stringify(f)),"object"===("undefined"==typeof b?"undefined":g(b))&&(b=JSON.stringify(b),h=JSON.stringify(h)),f!==a&&console.warn(a+" was incorrectly encoded as "+f),h!==b&&console.warn(b+" was incorrectly encoded as "+h)}return e};var w=new f;c.IDBFactory=f,c.shimIndexedDB=w},{"./DOMException.js":8,"./Event.js":9,"./IDBDatabase.js":11,"./IDBRequest.js":16,"./IDBTransaction.js":17,"./Key.js":18,"./util.js":21}],13:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){this.objectStore=a,this.name=b.columnName,this.keyPath=b.keyPath,this.multiEntry=b.optionalParams&&b.optionalParams.multiEntry,this.unique=b.optionalParams&&b.optionalParams.unique,this.__deleted=!!b.__deleted}Object.defineProperty(c,"__esModule",{value:!0});var f=a("./DOMException.js"),g=a("./util.js"),h=d(g),i=a("./Key.js"),j=d(i),k=a("./IDBKeyRange.js"),l=d(k),m=a("./IDBCursor.js"),n=a("./Sca.js"),o=d(n),p="undefined"!=typeof window?window:GLOBAL;e.__clone=function(a,b){return new e(b,{columnName:a.name,keyPath:a.keyPath,optionalParams:{multiEntry:a.multiEntry,unique:a.unique}})},e.__createIndex=function(a,b){var c=!!a.__indexes[b.name]&&a.__indexes[b.name].__deleted;a.__indexes[b.name]=b,a.indexNames.push(b.name);var d=a.transaction;d.__addToTransactionQueue(function(d,g,i,k){function l(a,c){k((0,f.createDOMException)(0,'Could not create index "'+b.name+'"',c))}function m(c){e.__updateIndexList(a,c,function(){c.executeSql("SELECT * FROM "+h["default"].quote(a.name),[],function(c,d){function e(f){if(f<d.rows.length)try{var g=o["default"].decode(d.rows.item(f).value),k=j["default"].getValue(g,b.keyPath);k=j["default"].encode(k,b.multiEntry),c.executeSql("UPDATE "+h["default"].quote(a.name)+" set "+h["default"].quote(b.name)+" = ? where key = ?",[k,d.rows.item(f).key],function(a,b){e(f+1)},l)}catch(m){e(f+1)}else i(a)}p.DEBUG&&console.log("Adding existing "+a.name+" records to the "+b.name+" index"),e(0)},l)},l)}if(c)m(d);else{var n=["ALTER TABLE",h["default"].quote(a.name),"ADD",h["default"].quote(b.name),"BLOB"].join(" ");p.DEBUG&&console.log(n),d.executeSql(n,[],m,l)}})},e.__deleteIndex=function(a,b){a.__indexes[b.name].__deleted=!0,a.indexNames.splice(a.indexNames.indexOf(b.name),1);var c=a.transaction;c.__addToTransactionQueue(function(c,d,g,h){function i(a,c){h((0,f.createDOMException)(0,'Could not delete index "'+b.name+'"',c))}e.__updateIndexList(a,c,g,i)})},e.__updateIndexList=function(a,b,c,d){for(var e={},f=0;f<a.indexNames.length;f++){var g=a.__indexes[a.indexNames[f]];e[g.name]={columnName:g.name,keyPath:g.keyPath,optionalParams:{unique:g.unique,multiEntry:g.multiEntry},deleted:!!g.deleted}}p.DEBUG&&console.log("Updating the index list for "+a.name,e),b.executeSql("UPDATE __sys__ set indexList = ? where name = ?",[JSON.stringify(e),a.name],function(){c(a)},d)},e.prototype.__fetchIndexData=function(a,b){var c=this,d=void 0,e=void 0;return 1===arguments.length?(b=a,d=!1):(j["default"].validate(a),e=j["default"].encode(a,c.multiEntry),d=!0),c.objectStore.transaction.__addToTransactionQueue(function(a,f,g,i){var k=["SELECT * FROM",h["default"].quote(c.objectStore.name),"WHERE",h["default"].quote(c.name),"NOT NULL"],l=[];d&&(c.multiEntry?(k.push("AND",h["default"].quote(c.name),"LIKE ?"),l.push("%"+e+"%")):(k.push("AND",h["default"].quote(c.name),"= ?"),l.push(e))),p.DEBUG&&console.log("Trying to fetch data for Index",k.join(" "),l),a.executeSql(k.join(" "),l,function(a,f){var h=0,i=null;if(c.multiEntry)for(var k=0;k<f.rows.length;k++){var l=f.rows.item(k),m=j["default"].decode(l[c.name]);d&&j["default"].isMultiEntryMatch(e,l[c.name])?(h++,i=i||l):d||void 0===m||(h+=m instanceof Array?m.length:1,i=i||l)}else h=f.rows.length,i=h&&f.rows.item(0);g("count"===b?h:0===h?void 0:"key"===b?j["default"].decode(i.key):o["default"].decode(i.value))},i)})},e.prototype.openCursor=function(a,b){return new m.IDBCursor(a,b,this.objectStore,this,this.name,"value").__req},e.prototype.openKeyCursor=function(a,b){return new m.IDBCursor(a,b,this.objectStore,this,this.name,"key").__req},e.prototype.get=function(a){if(0===arguments.length)throw new TypeError("No key was specified");return this.__fetchIndexData(a,"value")},e.prototype.getKey=function(a){if(0===arguments.length)throw new TypeError("No key was specified");return this.__fetchIndexData(a,"key")},e.prototype.count=function(a){return void 0===a?this.__fetchIndexData("count"):a instanceof l["default"]?new m.IDBCursor(a,"next",this.objectStore,this,this.name,"value",!0).__req:this.__fetchIndexData(a,"count")},c["default"]=e},{"./DOMException.js":8,"./IDBCursor.js":10,"./IDBKeyRange.js":14,"./Key.js":18,"./Sca.js":19,"./util.js":21}],14:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c,d){void 0!==a&&g["default"].validate(a),void 0!==b&&g["default"].validate(b),this.lower=a,this.upper=b,this.lowerOpen=!!c,this.upperOpen=!!d}Object.defineProperty(c,"__esModule",{value:!0});var f=a("./Key.js"),g=d(f);e.only=function(a){return new e(a,a,!1,!1)},e.lowerBound=function(a,b){return new e(a,void 0,b,void 0)},e.upperBound=function(a,b){return new e(void 0,a,void 0,b)},e.bound=function(a,b,c,d){return new e(a,b,c,d)},c["default"]=e},{"./Key.js":18}],15:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){this.name=a.name,this.keyPath=JSON.parse(a.keyPath),this.transaction=b,this.autoIncrement="string"==typeof a.autoInc?"true"===a.autoInc:!!a.autoInc,this.__indexes={},this.indexNames=new i["default"].StringList;var c=JSON.parse(a.indexList);for(var d in c)if(c.hasOwnProperty(d)){var e=new p["default"](this,c[d]);this.__indexes[e.name]=e,e.__deleted||this.indexNames.push(e.name)}}Object.defineProperty(c,"__esModule",{value:!0});var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a},g=a("./DOMException.js"),h=a("./util.js"),i=d(h),j=a("./Key.js"),k=d(j),l=a("./IDBKeyRange.js"),m=d(l),n=a("./IDBCursor.js"),o=a("./IDBIndex.js"),p=d(o),q=a("./IDBTransaction.js"),r=d(q),s=a("./Sca.js"),t=d(s),u="undefined"!=typeof window?window:GLOBAL;e.__clone=function(a,b){var c=new e({name:a.name,keyPath:JSON.stringify(a.keyPath),autoInc:JSON.stringify(a.autoIncrement),indexList:"{}"},b);return c.__indexes=a.__indexes,c.indexNames=a.indexNames,c},e.__createObjectStore=function(a,b){a.__objectStores[b.name]=b,a.objectStoreNames.push(b.name);var c=a.__versionTransaction;r["default"].__assertVersionChange(c),c.__addToTransactionQueue(function(a,c,d,e){function f(a,c){throw(0,g.createDOMException)(0,'Could not create object store "'+b.name+'"',c)}var h=["CREATE TABLE",i["default"].quote(b.name),"(key BLOB",b.autoIncrement?"UNIQUE, inc INTEGER PRIMARY KEY AUTOINCREMENT":"PRIMARY KEY",", value BLOB)"].join(" ");u.DEBUG&&console.log(h),a.executeSql(h,[],function(a,c){a.executeSql("INSERT INTO __sys__ VALUES (?,?,?,?)",[b.name,JSON.stringify(b.keyPath),b.autoIncrement,"{}"],function(){d(b)},f)},f)})},e.__deleteObjectStore=function(a,b){a.__objectStores[b.name]=void 0,a.objectStoreNames.splice(a.objectStoreNames.indexOf(b.name),1);var c=a.__versionTransaction;r["default"].__assertVersionChange(c),c.__addToTransactionQueue(function(a,c,d,e){function f(a,b){e((0,g.createDOMException)(0,"Could not delete ObjectStore",b))}a.executeSql("SELECT * FROM __sys__ where name = ?",[b.name],function(a,c){c.rows.length>0&&a.executeSql("DROP TABLE "+i["default"].quote(b.name),[],function(){a.executeSql("DELETE FROM __sys__ WHERE name = ?",[b.name],function(){d()},f)},f)})})},e.prototype.__validateKey=function(a,b){if(this.keyPath){if("undefined"!=typeof b)throw(0,g.createDOMException)("DataError","The object store uses in-line keys and the key parameter was provided",this);if(!a||"object"!==("undefined"==typeof a?"undefined":f(a)))throw(0,g.createDOMException)("DataError","KeyPath was specified, but value was not an object");if(b=k["default"].getValue(a,this.keyPath),void 0===b){if(this.autoIncrement)return;throw(0,g.createDOMException)("DataError","Could not eval key from keyPath")}}else if("undefined"==typeof b){if(this.autoIncrement)return;throw(0,g.createDOMException)("DataError","The object store uses out-of-line keys and has no key generator and the key parameter was not provided. ",this)}k["default"].validate(b)},e.prototype.__deriveKey=function(a,b,c,d,e){function f(b){a.executeSql("SELECT * FROM sqlite_sequence where name like ?",[h.name],function(a,c){b(1!==c.rows.length?1:c.rows.item(0).seq+1)},function(a,b){e((0,g.createDOMException)("DataError","Could not get the auto increment value for key",b))})}var h=this;if(h.keyPath){var i=k["default"].getValue(b,h.keyPath);void 0===i&&h.autoIncrement?f(function(a){try{k["default"].setValue(b,h.keyPath,a),d(a)}catch(c){e((0,g.createDOMException)("DataError","Could not assign a generated value to the keyPath",c))}}):d(i)}else"undefined"==typeof c&&h.autoIncrement?f(d):d(c)},e.prototype.__insertData=function(a,b,c,d,e,f){try{var h={};"undefined"!=typeof d&&(k["default"].validate(d),h.key=k["default"].encode(d));for(var j=0;j<this.indexNames.length;j++){var l=this.__indexes[this.indexNames[j]];h[l.name]=k["default"].encode(k["default"].getValue(c,l.keyPath),l.multiEntry)}var m=["INSERT INTO ",i["default"].quote(this.name),"("],n=[" VALUES ("],o=[];for(var p in h)m.push(i["default"].quote(p)+","),n.push("?,"),o.push(h[p]);m.push("value )"),n.push("?)"),o.push(b);var q=m.join(" ")+n.join(" ");u.DEBUG&&console.log("SQL for adding",q,o),a.executeSql(q,o,function(a,b){t["default"].encode(d,function(a){a=t["default"].decode(a),e(a)})},function(a,b){f((0,g.createDOMError)("ConstraintError",b.message,b))})}catch(r){f(r)}},e.prototype.add=function(a,b){var c=this;if(0===arguments.length)throw new TypeError("No value was specified");this.__validateKey(a,b),c.transaction.__assertWritable();var d=c.transaction.__createRequest();return c.transaction.__pushToQueue(d,function(d,e,f,g){c.__deriveKey(d,a,b,function(b){t["default"].encode(a,function(e){c.__insertData(d,e,a,b,f,g)})},g)}),d},e.prototype.put=function(a,b){var c=this;if(0===arguments.length)throw new TypeError("No value was specified");this.__validateKey(a,b),c.transaction.__assertWritable();var d=c.transaction.__createRequest();return c.transaction.__pushToQueue(d,function(d,e,f,g){c.__deriveKey(d,a,b,function(b){t["default"].encode(a,function(e){k["default"].validate(b);var h="DELETE FROM "+i["default"].quote(c.name)+" where key = ?";d.executeSql(h,[k["default"].encode(b)],function(d,h){u.DEBUG&&console.log("Did the row with the",b,"exist? ",h.rowsAffected),c.__insertData(d,e,a,b,f,g)},function(a,b){g(b)})})},g)}),d},e.prototype.get=function(a){var b=this;if(0===arguments.length)throw new TypeError("No key was specified");k["default"].validate(a);var c=k["default"].encode(a);return b.transaction.__addToTransactionQueue(function(a,d,e,f){u.DEBUG&&console.log("Fetching",b.name,c),a.executeSql("SELECT * FROM "+i["default"].quote(b.name)+" where key = ?",[c],function(a,b){u.DEBUG&&console.log("Fetched data",b);var c=void 0;try{if(0===b.rows.length)return e();c=t["default"].decode(b.rows.item(0).value)}catch(d){u.DEBUG&&console.log(d)}e(c)},function(a,b){f(b)})})},e.prototype["delete"]=function(a){var b=this;if(0===arguments.length)throw new TypeError("No key was specified");b.transaction.__assertWritable(),k["default"].validate(a);var c=k["default"].encode(a);return b.transaction.__addToTransactionQueue(function(a,d,e,f){u.DEBUG&&console.log("Fetching",b.name,c),a.executeSql("DELETE FROM "+i["default"].quote(b.name)+" where key = ?",[c],function(a,b){u.DEBUG&&console.log("Deleted from database",b.rowsAffected),e()},function(a,b){f(b)})})},e.prototype.clear=function(){var a=this;return a.transaction.__assertWritable(),a.transaction.__addToTransactionQueue(function(b,c,d,e){b.executeSql("DELETE FROM "+i["default"].quote(a.name),[],function(a,b){u.DEBUG&&console.log("Cleared all records from database",b.rowsAffected),d()},function(a,b){e(b)})})},e.prototype.count=function(a){var b=this;if(a instanceof m["default"])return new n.IDBCursor(a,"next",this,this,"key","value",!0).__req;var c=function(){var c=b,d=!1;return void 0!==a&&(d=!0,k["default"].validate(a)),{v:c.transaction.__addToTransactionQueue(function(b,e,f,g){var h="SELECT * FROM "+i["default"].quote(c.name)+(d?" WHERE key = ?":""),j=[];d&&j.push(k["default"].encode(a)),b.executeSql(h,j,function(a,b){f(b.rows.length)},function(a,b){g(b)})})}}();return"object"===("undefined"==typeof c?"undefined":f(c))?c.v:void 0},e.prototype.openCursor=function(a,b){return new n.IDBCursor(a,b,this,this,"key","value").__req},e.prototype.index=function(a){if(0===arguments.length)throw new TypeError("No index name was specified");var b=this.__indexes[a];if(!b)throw(0,g.createDOMException)("NotFoundError",'Index "'+a+'" does not exist on '+this.name);return p["default"].__clone(b,this)},e.prototype.createIndex=function(a,b,c){if(0===arguments.length)throw new TypeError("No index name was specified");if(1===arguments.length)throw new TypeError("No key path was specified");if(b instanceof Array&&c&&c.multiEntry)throw(0,g.createDOMException)("InvalidAccessError","The keyPath argument was an array and the multiEntry option is true.");if(this.__indexes[a]&&!this.__indexes[a].__deleted)throw(0,g.createDOMException)("ConstraintError",'Index "'+a+'" already exists on '+this.name);this.transaction.__assertVersionChange(),c=c||{};var d={columnName:a,keyPath:b,optionalParams:{unique:!!c.unique,multiEntry:!!c.multiEntry}},e=new p["default"](this,d);return p["default"].__createIndex(this,e),e},e.prototype.deleteIndex=function(a){if(0===arguments.length)throw new TypeError("No index name was specified");var b=this.__indexes[a];if(!b)throw(0,g.createDOMException)("NotFoundError",'Index "'+a+'" does not exist on '+this.name);this.transaction.__assertVersionChange(),p["default"].__deleteIndex(this,b)},c["default"]=e},{"./DOMException.js":8,"./IDBCursor.js":10,"./IDBIndex.js":13,"./IDBKeyRange.js":14,"./IDBTransaction.js":17,"./Key.js":18,"./Sca.js":19,"./util.js":21}],16:[function(a,b,c){"use strict";function d(){this.onsuccess=this.onerror=this.result=this.error=this.source=this.transaction=null,this.readyState="pending"}function e(){this.onblocked=this.onupgradeneeded=null}Object.defineProperty(c,"__esModule",{value:!0}),e.prototype=new d,e.prototype.constructor=e,c.IDBRequest=d,c.IDBOpenDBRequest=e},{}],17:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b,c){this.__id=++p,this.__active=!0,this.__running=!1,this.__errored=!1,this.__requests=[],this.__storeNames=b,this.mode=c,this.db=a,this.error=null,this.onabort=this.onerror=this.oncomplete=null;var d=this;setTimeout(function(){d.__executeRequests()},0)}Object.defineProperty(c,"__esModule",{value:!0});var f=a("eventtarget"),g=d(f),h=a("./Event.js"),i=a("./DOMException.js"),j=a("./IDBRequest.js"),k=a("./util.js"),l=d(k),m=a("./IDBObjectStore.js"),n=d(m),o="undefined"!=typeof window?window:GLOBAL,p=0;e.prototype.__executeRequests=function(){function a(a){if((0,i.logError)("Error","An error occurred in a transaction",a),!c.__errored){if(c.__errored=!0,!c.__active)throw a;try{c.error=a;var b=(0,h.createEvent)("error");l["default"].callback("onerror",c,b),l["default"].callback("onerror",c.db,b)}finally{c.abort()}}}function b(){o.DEBUG&&console.log("Transaction completed");var a=(0,h.createEvent)("complete");try{l["default"].callback("oncomplete",c,a),l["default"].callback("__oncomplete",c,a)}catch(b){throw c.__errored=!0,b}}if(this.__running)return void(o.DEBUG&&console.log("Looks like the request set is already running",this.mode));this.__running=!0;var c=this;c.db.__db.transaction(function(d){function e(a,b){b&&(j.req=b),j.req.readyState="done",j.req.result=a,delete j.req.error;var c=(0,h.createEvent)("success");l["default"].callback("onsuccess",j.req,c),k++,g()}function f(b,c){c=(0,i.findError)(arguments);try{j.req.readyState="done",j.req.error=c||i.DOMError,j.req.result=void 0;var d=(0,h.createEvent)("error",c);l["default"].callback("onerror",j.req,d)}finally{a(c)}}function g(){if(k>=c.__requests.length)c.__requests=[],c.__active&&(c.__active=!1,b());else try{j=c.__requests[k],j.op(d,j.args,e,f)}catch(a){f(a)}}c.__tx=d;var j=null,k=0;g()},function(b){a(b)})},e.prototype.__createRequest=function(){var a=new j.IDBRequest;return a.source=this.db,a.transaction=this,a},e.prototype.__addToTransactionQueue=function(a,b){var c=this.__createRequest();return this.__pushToQueue(c,a,b),c},e.prototype.__pushToQueue=function(a,b,c){this.__assertActive(),this.__requests.push({op:b,args:c,req:a})},e.prototype.__assertActive=function(){if(!this.__active)throw(0,i.createDOMException)("TransactionInactiveError","A request was placed against a transaction which is currently not active, or which is finished")},e.prototype.__assertWritable=function(){if(this.mode===e.READ_ONLY)throw(0,i.createDOMException)("ReadOnlyError","The transaction is read only")},e.prototype.__assertVersionChange=function(){e.__assertVersionChange(this)},e.__assertVersionChange=function(a){if(!a||a.mode!==e.VERSION_CHANGE)throw(0,i.createDOMException)("InvalidStateError","Not a version transaction")},e.prototype.objectStore=function(a){if(0===arguments.length)throw new TypeError("No object store name was specified");if(!this.__active)throw(0,i.createDOMException)("InvalidStateError","A request was placed against a transaction which is currently not active, or which is finished");if(-1===this.__storeNames.indexOf(a)&&this.mode!==e.VERSION_CHANGE)throw(0,i.createDOMException)("NotFoundError",a+" is not participating in this transaction");var b=this.db.__objectStores[a];if(!b)throw(0,i.createDOMException)("NotFoundError",a+" does not exist in "+this.db.name);return n["default"].__clone(b,this)},e.prototype.abort=function(){var a=this;o.DEBUG&&console.log("The transaction was aborted",a),a.__active=!1;var b=(0,h.createEvent)("abort");setTimeout(function(){l["default"].callback("onabort",a,b)},0)},Object.assign(e.prototype,g["default"].prototype),e.READ_ONLY="readonly",e.READ_WRITE="readwrite",e.VERSION_CHANGE="versionchange",c["default"]=e},{"./DOMException.js":8,"./Event.js":9,"./IDBObjectStore.js":15,"./IDBRequest.js":16,"./util.js":21,eventtarget:4}],18:[function(require,module,exports){"use strict";function padBase32Exponent(a){return a=a.toString(32),1===a.length?"0"+a:a}function padBase32Mantissa(a){return(a+zeros(11)).slice(0,11)}function flipBase32(a){for(var b="",c=0;c<a.length;c++)b+=(31-parseInt(a[c],32)).toString(32);return b}function pow32(a,b){if(b=parseInt(b,32),0>b)return roundToPrecision(parseInt(a,32)*Math.pow(32,b-10));if(11>b){var c=a.slice(0,b);c=parseInt(c,32);var d=a.slice(b);return d=parseInt(d,32)*Math.pow(32,b-11),roundToPrecision(c+d)}var e=a+zeros(b-11);return parseInt(e,32)}function roundToPrecision(a,b){return b=b||16,parseFloat(a.toPrecision(b))}function zeros(a){for(var b="";a--;)b+="0";return b}function negate(a){return"-"+a}function getType(a){return a instanceof Date?"date":a instanceof Array?"array":"undefined"==typeof a?"undefined":_typeof(a)}function validate(a){var b=getType(a);if("array"===b)for(var c=0;c<a.length;c++)validate(a[c]);else if(!types[b]||"string"!==b&&isNaN(a))throw(0,_DOMException.createDOMException)("DataError","Not a valid key")}function getValue(source,keyPath){try{if(keyPath instanceof Array){for(var arrayValue=[],i=0;i<keyPath.length;i++)arrayValue.push(eval("source."+keyPath[i]));return arrayValue}return eval("source."+keyPath)}catch(e){return}}function setValue(a,b,c){for(var d=b.split("."),e=0;e<d.length-1;e++){var f=d[e];a=a[f]=a[f]||{}}a[d[d.length-1]]=c}function isMultiEntryMatch(a,b){var c=collations[b.substring(0,1)];return"array"===c?b.indexOf(a)>1:b===a}function isKeyInRange(a,b){var c=void 0===b.lower,d=void 0===b.upper,e=_encode(a,!0);return void 0!==b.lower&&(b.lowerOpen&&e>b.__lower&&(c=!0),!b.lowerOpen&&e>=b.__lower&&(c=!0)),void 0!==b.upper&&(b.upperOpen&&e<b.__upper&&(d=!0),!b.upperOpen&&e<=b.__upper&&(d=!0)),c&&d}function findMultiEntryMatches(a,b){var c=[];if(a instanceof Array)for(var d=0;d<a.length;d++){var e=a[d];if(e instanceof Array){if(b.lower===b.upper)continue;if(1!==e.length){var f=findMultiEntryMatches(e,b);f.length>0&&c.push(e);continue}e=e[0]}isKeyInRange(e,b)&&c.push(e)}else isKeyInRange(a,b)&&c.push(a);return c}function _encode(a,b){return void 0===a?null:types[getType(a)].encode(a,b)}function _decode(a,b){return"string"==typeof a?types[collations[a.substring(0,1)]].decode(a,b):void 0}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=exports.findMultiEntryMatches=exports.isMultiEntryMatch=exports.setValue=exports.getValue=exports.validate=exports.decode=exports.encode=void 0;var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a},_DOMException=require("./DOMException.js"),Key={},collations=["undefined","number","date","string","array"],signValues=["negativeInfinity","bigNegative","smallNegative","smallPositive","bigPositive","positiveInfinity"],types={undefined:{encode:function(a){return collations.indexOf("undefined")+"-"},decode:function(a){}},date:{encode:function(a){return collations.indexOf("date")+"-"+a.toJSON()},decode:function(a){return new Date(a.substring(2))}},number:{encode:function(a){var b=Math.abs(a).toString(32),c=b.indexOf(".");b=-1!==c?b.replace(".",""):b;var d=b.search(/[^0]/);b=b.slice(d);var e=void 0,f=zeros(2),g=zeros(11);return isFinite(a)?0>a?a>-1?(e=signValues.indexOf("smallNegative"),f=padBase32Exponent(d),g=flipBase32(padBase32Mantissa(b))):(e=signValues.indexOf("bigNegative"),f=flipBase32(padBase32Exponent(-1!==c?c:b.length)),g=flipBase32(padBase32Mantissa(b))):1>a?(e=signValues.indexOf("smallPositive"),f=flipBase32(padBase32Exponent(d)),g=padBase32Mantissa(b)):(e=signValues.indexOf("bigPositive"),f=padBase32Exponent(-1!==c?c:b.length),g=padBase32Mantissa(b)):e=signValues.indexOf(a>0?"positiveInfinity":"negativeInfinity"),collations.indexOf("number")+"-"+e+f+g},decode:function(a){var b=+a.substr(2,1),c=a.substr(3,2),d=a.substr(5,11);switch(signValues[b]){case"negativeInfinity":return-(1/0);case"positiveInfinity":return 1/0;case"bigPositive":return pow32(d,c);case"smallPositive":return c=negate(flipBase32(c)),pow32(d,c);case"smallNegative":
return c=negate(c),d=flipBase32(d),-pow32(d,c);case"bigNegative":return c=flipBase32(c),d=flipBase32(d),-pow32(d,c);default:throw new Error("Invalid number.")}}},string:{encode:function(a,b){return b&&(a=a.replace(/(.)/g,"-$1")+" "),collations.indexOf("string")+"-"+a},decode:function(a,b){return a=a.substring(2),b&&(a=a.substr(0,a.length-1).replace(/-(.)/g,"$1")),a}},array:{encode:function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c],e=_encode(d,!0);b[c]=e}return b.push(collations.indexOf("undefined")+"-"),collations.indexOf("array")+"-"+JSON.stringify(b)},decode:function(a){var b=JSON.parse(a.substring(2));b.pop();for(var c=0;c<b.length;c++){var d=b[c],e=_decode(d,!0);b[c]=e}return b}}};exports["default"]=Key={encode:_encode,decode:_decode,validate:validate,getValue:getValue,setValue:setValue,isMultiEntryMatch:isMultiEntryMatch,findMultiEntryMatches:findMultiEntryMatches},exports.encode=_encode,exports.decode=_decode,exports.validate=validate,exports.getValue=getValue,exports.setValue=setValue,exports.isMultiEntryMatch=isMultiEntryMatch,exports.findMultiEntryMatches=findMultiEntryMatches,exports["default"]=Key},{"./DOMException.js":8}],19:[function(require,module,exports){"use strict";function _interopRequireDefault(a){return a&&a.__esModule?a:{"default":a}}function decycle(object,callback){function checkForCompletion(){0===queuedObjects.length&&returnCallback(derezObj)}function readBlobAsDataURL(a,b){var c=new FileReader;c.onloadend=function(c){var d=c.target.result,e="Blob";a instanceof File,updateEncodedBlob(d,b,e)},c.readAsDataURL(a)}function updateEncodedBlob(dataURL,path,blobtype){var encoded=queuedObjects.indexOf(path);path=path.replace("$","derezObj"),eval(path+'.$enc="'+dataURL+'"'),eval(path+'.$type="'+blobtype+'"'),queuedObjects.splice(encoded,1),checkForCompletion()}function derez(a,b){var c=void 0,d=void 0,e=void 0;if(!("object"!==("undefined"==typeof a?"undefined":_typeof(a))||null===a||a instanceof Boolean||a instanceof Date||a instanceof Number||a instanceof RegExp||a instanceof Blob||a instanceof String)){for(c=0;c<objects.length;c+=1)if(objects[c]===a)return{$ref:paths[c]};if(objects.push(a),paths.push(b),"[object Array]"===Object.prototype.toString.apply(a))for(e=[],c=0;c<a.length;c+=1)e[c]=derez(a[c],b+"["+c+"]");else{e={};for(d in a)Object.prototype.hasOwnProperty.call(a,d)&&(e[d]=derez(a[d],b+"["+JSON.stringify(d)+"]"))}return e}return a instanceof Blob?(queuedObjects.push(b),readBlobAsDataURL(a,b)):a instanceof Boolean?a={$type:"Boolean",$enc:a.toString()}:a instanceof Date?a={$type:"Date",$enc:a.getTime()}:a instanceof Number?a={$type:"Number",$enc:a.toString()}:a instanceof RegExp?a={$type:"RegExp",$enc:a.toString()}:"number"==typeof a?a={$type:"number",$enc:a+""}:void 0===a&&(a={$type:"undefined"}),a}var objects=[],paths=[],queuedObjects=[],returnCallback=callback,derezObj=void 0;derezObj=derez(object,"$"),checkForCompletion()}function retrocycle($){function dataURLToBlob(a){var b=";base64,",c=void 0,d=void 0,e=void 0;if(-1===a.indexOf(b))return d=a.split(","),c=d[0].split(":")[1],e=d[1],new Blob([e],{type:c});d=a.split(b),c=d[0].split(":")[1],e=(0,_atob2["default"])(d[1]);for(var f=e.length,g=new Uint8Array(f),h=0;f>h;++h)g[h]=e.charCodeAt(h);return new Blob([g.buffer],{type:c})}function rez(value){var i=void 0,item=void 0,name=void 0,path=void 0;if(value&&"object"===("undefined"==typeof value?"undefined":_typeof(value)))if("[object Array]"===Object.prototype.toString.apply(value))for(i=0;i<value.length;i+=1)item=value[i],item&&"object"===("undefined"==typeof item?"undefined":_typeof(item))&&(path=item.$ref,"string"==typeof path&&px.test(path)?value[i]=eval(path):value[i]=rez(item));else if(void 0!==value.$type)switch(value.$type){case"Blob":case"File":value=dataURLToBlob(value.$enc);break;case"Boolean":value=Boolean("true"===value.$enc);break;case"Date":value=new Date(value.$enc);break;case"Number":value=Number(value.$enc);break;case"RegExp":value=eval(value.$enc);break;case"number":value=parseFloat(value.$enc);break;case"undefined":value=void 0}else for(name in value)"object"===_typeof(value[name])&&(item=value[name],item&&(path=item.$ref,"string"==typeof path&&px.test(path)?value[name]=eval(path):value[name]=rez(item)));return value}var px=/^\$(?:\[(?:\d+|"(?:[^\\"\u0000-\u001f]|\\([\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*")\])*$/;return rez($)}function encode(a,b){function c(a){b(JSON.stringify(a))}decycle(a,c)}function decode(a){return retrocycle(JSON.parse(a))}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=exports.decode=exports.encode=exports.retrocycle=exports.decycle=void 0;var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a},_atob=require("atob"),_atob2=_interopRequireDefault(_atob),Sca={decycle:decycle,retrocycle:retrocycle,encode:encode,decode:decode};exports.decycle=decycle,exports.retrocycle=retrocycle,exports.encode=encode,exports.decode=decode,exports["default"]=Sca},{atob:1}],20:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0}),c["default"]=c.shimIndexedDB=c.IDBFactory=c.IDBOpenDBRequest=c.IDBRequest=c.IDBDatabase=c.IDBTransaction=c.IDBIndex=c.IDBObjectStore=c.IDBCursorWithValue=c.IDBCursor=c.IDBKeyRange=c.IDBVersionChangeEvent=void 0;var e=a("websql"),f=d(e),g=a("./Event.js"),h=a("./IDBKeyRange.js"),i=d(h),j=a("./IDBCursor.js"),k=a("./IDBObjectStore.js"),l=d(k),m=a("./IDBIndex.js"),n=d(m),o=a("./IDBTransaction.js"),p=d(o),q=a("./IDBDatabase.js"),r=d(q),s=a("./IDBRequest.js"),t=a("./IDBFactory.js");GLOBAL.nodeWebsql=f["default"],c.IDBVersionChangeEvent=g.IDBVersionChangeEvent,c.IDBKeyRange=i["default"],c.IDBCursor=j.IDBCursor,c.IDBCursorWithValue=j.IDBCursorWithValue,c.IDBObjectStore=l["default"],c.IDBIndex=n["default"],c.IDBTransaction=p["default"],c.IDBDatabase=r["default"],c.IDBRequest=s.IDBRequest,c.IDBOpenDBRequest=s.IDBOpenDBRequest,c.IDBFactory=t.IDBFactory,c.shimIndexedDB=t.shimIndexedDB,c["default"]=t.shimIndexedDB},{"./Event.js":9,"./IDBCursor.js":10,"./IDBDatabase.js":11,"./IDBFactory.js":12,"./IDBIndex.js":13,"./IDBKeyRange.js":14,"./IDBObjectStore.js":15,"./IDBRequest.js":16,"./IDBTransaction.js":17,websql:7}],21:[function(a,b,c){"use strict";function d(a,b,c){c.target=b,"function"==typeof b[a]&&b[a](c)}function e(a){return'"'+a+'"'}Object.defineProperty(c,"__esModule",{value:!0});var f=!1,g={test:!0};if(Object.defineProperty)try{Object.defineProperty(g,"test",{enumerable:!1}),g.test&&(f=!0)}catch(h){}var i=function(){this.length=0,this._items=[],f&&Object.defineProperty(this,"_items",{enumerable:!1})};if(i.prototype={contains:function(a){return-1!==this._items.indexOf(a)},item:function(a){return this._items[a]},indexOf:function(a){return this._items.indexOf(a)},push:function(a){this._items.push(a),this.length+=1;for(var b=0;b<this._items.length;b++)this[b]=this._items[b]},splice:function(){this._items.splice.apply(this._items,arguments),this.length=this._items.length;for(var a in this)a===String(parseInt(a,10))&&delete this[a];for(var b=0;b<this._items.length;b++)this[b]=this._items[b]}},f)for(var j in{indexOf:!1,push:!1,splice:!1})Object.defineProperty(i.prototype,j,{enumerable:!1});var k={callback:d,StringList:i,quote:e};c.callback=d,c.StringList=i,c.quote=e,c["default"]=k},{}]},{},[20]);
//# sourceMappingURL=indexeddbshim-node.min.js.map